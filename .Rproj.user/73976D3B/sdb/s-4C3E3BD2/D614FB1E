{
    "contents" : "library(\"colorspace\", lib.loc=\"~/R/win-library/3.1\")\nlibrary(reshape2)\nlibrary(gee)\nlibrary(ggplot2)\nlibrary(foreign)\nlibrary(mgcv)\nlibrary(stats)\nlibrary(rmarkdown)\nlibrary(knitr)\nprint(sessionInfo(), locale=FALSE)\n\ngetwd()\n# import the csv file in this same folder - assuming that we opened this in RStudio\n# such that the working directory is .../Heathers trials and tribulations\nAHRR_GEE <- read.csv(\"AHRR_GEE.csv\")\nhead(AHRR_GEE, 2)\n\nKdf<-dput(names(AHRR_GEE)) #restricted in SAS to non-outliers >20 for ahrr_pos1, >40 for ahrr_pos2, >20 for ahrr_pos3\nKdf\n\n# here we specify a subset of the variables that we will need to go forward for use in this analysis\nmymethysites <- c(\"ahrr_pos1\", \"ahrr_pos2\", \"ahrr_pos3\")\n# covariates and identifiers (one observation per person)\n\nmycovars <- c(\"folio\", \"edad\", \"prepregnBMI\", \"Fenton_Z_score\", \"cbc_leuc\", \"cbc_neutroabs\", \"Christiani_Lab\", \"Plate_No\", \"Plate_Loc\", \"ahrr_mean\", \"preterm\", \"gest_age_days_d\", \"gest_age_weeks_d\", \"SGA\", \"AGA\", \"LGA\", \"ed_LT_12\", \"ed_12\", \"ed_gt_12\", \"ED_level\", \"multiparous\", \"smoke_house_outside\", \"male\", \"BMI_2T\", \"obese_2t\", \"overweight_2T\", \"normalweight_2T\", \"BMI_3Cat\", \"BWT_GA_3Cat\", \"folic_d\", \"cbc_linfo\", \"cbc_mono\", \"cbc_monoabs\", \"cbc_eosi\", \"cbc_baso\", \"cbc_hemat\", \"neut_perc_derived\", \"gran_perc_derived\", \"ahrr_pos1_sd\", \"ahrr_pos2_sd\",\"ahrr_pos3_sd\", \"ahrr_mean_sd\", \"nr3_ob_sd\")\n# restricting to just these variables\n#Still having trouble going to next line\nahrrdf2 <- AHRR_GEE[, c(mymethysites, mycovars)]\n\n# create a long dataset where all of the covars will be repeated\n# and each methylation observation will be one row\nahrrlong2 <- melt(ahrrdf2, id.vars = c(mycovars))\nhead(ahrrlong2, 3)\n\n# we add \"variable\" as an indicator for methylation site (allow different intercepts)\n# \"value\" is the methylation measure for a given folio-site combination\nmod2 <- gee(value ~ BMI_2T + variable, id = folio, corstr = \"exchangeable\", data = ahrrlong2) \nsummary(mod2)$coefficients\n# highly significant!!! (estimate for BMI_2T is more than 2x the robust SE)\n# see my old code for the summary function to pull out CI and p-value\n\n# checking if LM is similar\nmodx<-lm(ahrr_pos1~BMI_2T, data=AHRR_GEE)\nsummary(modx)\nmody<-lm(ahrr_pos2~BMI_2T, data=AHRR_GEE)\nsummary(mody)\nmodz<-lm(ahrr_pos3~BMI_2T, data=AHRR_GEE)\nsummary(modz)\n#MEAN\nmodzz<-lm(ahrr_mean~BMI_2T, data=AHRR_GEE)\nsummary(modzz)\n#GEE model VERY SIMILAR WITH MUCH BETTER P VALUE, but still same estimate\nprint.model(mod2)\n\n\n\ntable(ahrrdf2$SGA)\n\n# for another day - we will link this up to a remote github repo\n# git remote add origin https://github.com/hhburris/Heathers-K-anaylsis.git\n# git push -u origin master\n\nmod3 <- gee(value ~ BMI_2T + variable + Christiani_Lab, id = folio, corstr = \"exchangeable\", data = ahrrlong2) \nsummary(mod2)$coefficients\n\n\nmod4<- gee(value ~ BMI_2T + variable + Christiani_Lab + edad, id = folio, corstr = \"exchangeable\", data = ahrrlong2) \n\nmod5<-gee(value ~ BMI_2T + variable + Christiani_Lab + edad + gest_age_days_d, id = folio, corstr = \"exchangeable\", data = ahrrlong2)\n\nmod5<-gee(value ~ BMI_2T + variable + Christiani_Lab + edad + gest_age_days_d + ed_LT_12 + ed_gt_12, id = folio, corstr = \"exchangeable\", data = ahrrlong2)\nsummary(mod5)$coefficients\n\nprint.model <- function(model, exp = F, digits = 2){\n  se.coef <- if(class(model)[1] == \"gee\"){\n    summary(model)$coefficients[, \"Robust S.E.\"]} else {se.coef(model)}\n  if(exp == T){\n    or.df <- data.frame(OR = exp(coef(model)),\n                        lower = exp(coef(model) -1.96 * se.coef),\n                        upper = exp(coef(model) +1.96 * se.coef),\n                        pvalue = round(1.96*(1-pnorm(abs(coef(model)/se.coef))), digits + 2))\n  } else(\n    or.df <- data.frame(estimate = (coef(model)),\n                        lower = (coef(model) -1.96 * se.coef),\n                        upper = (coef(model) +1.96 * se.coef),\n                        pvalue = round(1.96*(1-pnorm(abs(coef(model)/se.coef))), digits + 2))\n    \n  )\n  print(or.df, digits = digits)\n}\n\n# print it out!\nprint.model(mod5)\n\n# FIGURE 1\n\nggplot(ahrrlong2, aes(variable, value, group = folio)) + \n  geom_point(position = position_jitter(height = 0, width = 0.1), alpha = 0.4) + \n  geom_line(alpha=0.2)+\n  theme_bw()+\n  theme(plot.title = element_text(size=20, face=\"bold\"))+\n  theme(axis.title.x = element_text(face=\"bold\", size=17))+\n  theme(axis.title.y = element_text(face=\"bold\", size=17)) +   \n  theme(legend.title = element_text(size=16, face=\"bold\"))+\n  ylab(\"DNA methylation (%5mC)\")+\n  xlab(\"AHRR CpG Site\")+\n  scale_x_discrete(breaks=c(\"ahrr_pos1\", \"ahrr_pos2\", \"ahrr_pos3\"), labels=c(\"CpG 1\", \"CpG 2\", \"CpG 3\"))\n\n# Add this if we want title \n#ggtitle(\"AHRR DNA Methylation\")+\n#annotate(\"text\", x =3.3,y = 80, label = \"A\", size=12, face=\"bold\")\nggplot(ahrrlong2, aes(variable, value, group = folio)) + \n  geom_point(position = position_jitter(height = 0, width = 0.1), alpha = 0.4) + \n  geom_line(alpha=0.2)+\n  theme_bw()+\n  theme(plot.title = element_text(size=20, face=\"bold\"))+\n  theme(axis.title.x = element_text(face=\"bold\", size=17))+\n  theme(axis.title.y = element_text(face=\"bold\", size=17)) +   \n  theme(legend.title = element_text(size=16, face=\"bold\"))+\n  ylab(\"DNA methylation (%5mC)\")+\n  xlab(\"AHRR CpG Site\")+\n  annotate(\"text\", x =1.3,y = 92, label = \"r=0.83\", size=7, face=\"bold\")+\n  annotate(\"text\", x =2.7,y = 92, label = \"r=0.61\", size=7, face=\"bold\")+\n  scale_x_discrete(breaks=c(\"ahrr_pos1\", \"ahrr_pos2\", \"ahrr_pos3\"), labels=c(\"CpG 1\", \"CpG 2\", \"CpG 3\"))+\n  theme(text = element_text(size=18, face=\"bold\"))\n\n\nggplot(ahrrlong2, aes(BMI_2T, value, color = variable)) + \n  geom_point() + geom_smooth(method = \"lm\") + theme_bw(13) + \n  ylab(\"DNA methylation (%5mC)\") + scale_color_hue(\"Site\", labels=c(\"CpG 1\", \"CpG 2\",\"CpG 3\")) + \n  xlab(\"Maternal BMI\")+\n  ggtitle(\"Associations of Maternal BMI and Offspring AHRR DNA Methylation\")\n\nggplot(ahrrlong2, aes(BMI_2T, value, color = variable)) + \n  geom_point() + geom_smooth(method = \"lm\") + theme_bw(13)+ theme(legend.title=element_text(size=16, face=\"bold\"))+ \n  ylab(\"AHRR DNA methylation (%5mC)\") + scale_color_hue(\"Site\", labels=c(\"CpG 1\", \"CpG 2\",\"CpG 3\")) + \n  xlab(\"Maternal BMI\")+\n  theme(plot.title = element_text(size=20, face=\"bold\"))+\n  theme(axis.title.x = element_text(face=\"bold\", size=17))+\n  theme(axis.title.y = element_text(face=\"bold\", size=17)) +   \n  theme(legend.title = element_text(size=16, face=\"bold\"))+\n  theme(text = element_text(size=18, face=\"bold\"))\n#title   ggtitle(\"Associations of Maternal BMI and Offspring AHRR DNA Methylation\")+\n\n\nggplot(ahrrlong2, aes(gest_age_weeks_d, value, color = variable)) + \n  geom_point() + geom_smooth(method = \"lm\") + theme_bw(13)+ theme(legend.title=element_text(size=16, face=\"bold\"))+ \n  ylab(\"AHRR DNA methylation (%5mC)\") + scale_color_hue(\"Site\", labels=c(\"CpG 1\", \"CpG 2\",\"CpG 3\")) + \n  xlab(\"Gestational Age (weeks)\")+\n  theme(plot.title = element_text(size=20, face=\"bold\"))+\n  theme(axis.title.x = element_text(face=\"bold\", size=17))+\n  theme(axis.title.y = element_text(face=\"bold\", size=17)) +   \n  theme(legend.title = element_text(size=16, face=\"bold\"))+\n  theme(text = element_text(size=18, face=\"bold\"))\n#title:   ggtitle(\"Associations of Gestational Age and Offspring AHRR DNA Methylation\")+\n\n\nggplot(ahrrlong2[ahrrlong2$gest_age_weeks_d >25,], aes(gest_age_weeks_d, value, color = variable)) + \n  geom_point() + geom_smooth(method = \"lm\") + theme_bw(13)+ theme(legend.title=element_text(size=16, face=\"bold\"))+ \n  ylab(\"AHRR DNA methylation (%5mC)\") + scale_color_hue(\"Site\", labels=c(\"CpG 1\", \"CpG 2\",\"CpG 3\")) + \n  xlab(\"Gestational Age (weeks)\")+\n  theme(plot.title = element_text(size=20, face=\"bold\"))+\n  theme(axis.title.x = element_text(face=\"bold\", size=17))+\n  theme(axis.title.y = element_text(face=\"bold\", size=17)) +   \n  theme(legend.title = element_text(size=16, face=\"bold\"))+\n  theme(text = element_text(size=18, face=\"bold\"))\n#title: ggtitle(\"Associations of Gestational Age and AHRR DNA Methylation\")+\n\nggplot(ahrrlong2, aes(Fenton_Z_score, value, color = variable)) + \n  geom_point() + geom_smooth(method = \"lm\") + theme_bw(13)+ theme(legend.title=element_text(size=16, face=\"bold\"))+ \n  ylab(\"AHRR DNA methylation (%5mC)\") + scale_color_hue(\"Site\", labels=c(\"CpG 1\", \"CpG 2\",\"CpG 3\")) + \n  xlab(\"BWT for GA (Z score))\")+\n  theme(plot.title = element_text(size=17, face=\"bold\"))+\n  theme(axis.title.x = element_text(face=\"bold\", size=17))+\n  theme(axis.title.y = element_text(face=\"bold\", size=17)) +   \n  theme(legend.title = element_text(size=16, face=\"bold\"))+\n  theme(text = element_text(size=18, face=\"bold\"))\n\n#title : ggtitle(\"Associations of Birth Weight-For-Gestational Age and Offspring AHRR DNA Methylation\")\n\n\n\n\n\n\n\n\n\n# Box plot\n\n\n# Maternal BMI Categories\na<-ggplot(AHRR_GEE, aes(factor(BMI_3Cat),ahrr_pos1))+\n  geom_boxplot(size=0.2)+theme_bw()+\n  theme_bw()+\n  theme(plot.title = element_text(size=20, face=\"bold\"))+\n  theme(axis.title.x = element_text(face=\"bold\", size=20))+\n  theme(axis.title.y = element_text(face=\"bold\", size=20)) +   \n  theme(legend.title = element_text(size=16, face=\"bold\"))+\n  ylab(\"Mean AHRR DNA methylation (%5mC)\")+\n  xlab(\"Maternal BMI Categories\")+\n  scale_x_discrete(breaks=c(\"1\", \"2\", \"3\"), labels=c(\"Normal Weight\", \"Overweight\", \"Obese\"))+\n  stat_summary(fun.y=mean, geom=\"point\", shape=5, size=4)+\n  theme(text = element_text(size=18, face=\"bold\"))\n\nnames(AHRR_GEE)\n\n# GA categories\nb<-ggplot(AHRR_GEE, aes(factor(preterm),ahrr_pos1))+\n  geom_boxplot(size=0.2)+theme_bw()+\n  theme_bw()+\n  theme(plot.title = element_text(size=20, face=\"bold\"))+\n  theme(axis.title.x = element_text(face=\"bold\", size=20))+\n  theme(axis.title.y = element_text(face=\"bold\", size=20)) +   \n  theme(legend.title = element_text(size=16, face=\"bold\"))+\n  ylab(\"AHRR (CpG 1) DNA methylation (%5mC)\")+\n  xlab(\"Gestational Age Categories\")+\n  scale_x_discrete(breaks=c(\"1\", \"0\"), labels=c(\"Preterm\", \"Full term\"))+\n  stat_summary(fun.y=mean, geom=\"point\", shape=5, size=4)+\n  theme(text = element_text(size=18, face=\"bold\"))\n\n# Getting rid of missings\nmycovars4 <- c(\"folio\", \"ahrr_pos1\", \"BWT_GA_3Cat\")\nnewBoxDF<-AHRR_GEE[,c(\"folio\", \"ahrr_pos1\", \"BWT_GA_3Cat\")]\nnomiss<-na.omit(newBoxDF)\n\n\nnomiss$BWT_GA_3Cat\n######Plot for DNA methylation and BWT GA Categoreis\nc<-ggplot(nomiss, aes(factor(BWT_GA_3Cat),ahrr_pos1))+\n  geom_boxplot(size=0.4)+theme_bw()+\n  theme_bw()+\n  theme(plot.title = element_text(size=20, face=\"bold\"))+\n  theme(axis.title.x = element_text(face=\"bold\", size=20))+\n  theme(axis.title.y = element_text(face=\"bold\", size=20)) +   \n  theme(legend.title = element_text(size=16, face=\"bold\"))+\n  ylab(\"AHRR (CpG 1) DNA methylation (%5mC)\")+\n  xlab(\"Birth Weight-for-Gestational Age Categories\")+\n  scale_x_discrete(breaks=c(\"1\", \"2\", \"3\"), labels=c(\"SGA\", \"AGA\", \"LGA\"))+\n  stat_summary(fun.y=mean, geom=\"point\", shape=5, size=4)+\n  theme(text = element_text(size=18, face=\"bold\"))\n\n\nsummary(AHRR_GEE$BWT_GA_3Cat[is.na=TRUE])\nmultiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {\n  require(grid)\n  \n  # Make a list from the ... arguments and plotlist\n  plots <- c(list(...), plotlist)\n  \n  numPlots = length(plots)\n  \n  # If layout is NULL, then use 'cols' to determine layout\n  if (is.null(layout)) {\n    # Make the panel\n    # ncol: Number of columns of plots\n    # nrow: Number of rows needed, calculated from # of cols\n    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),\n                     ncol = cols, nrow = ceiling(numPlots/cols))\n  }\n  \n  if (numPlots==1) {\n    print(plots[[1]])\n    \n  } else {\n    # Set up the page\n    grid.newpage()\n    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))\n    \n    # Make each plot, in the correct location\n    for (i in 1:numPlots) {\n      # Get the i,j matrix positions of the regions that contain this subplot\n      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))\n      \n      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,\n                                      layout.pos.col = matchidx$col))\n    }\n  }\n}\nmultiplot(a, b, c, cols=3)\n\n\n\n# Making it better with three across\n\nd<-ggplot(AHRR_GEE, aes(factor(BMI_3Cat),ahrr_pos1))+\n  geom_boxplot(size=0.2)+theme_bw()+\n  theme_bw()+\n  theme(plot.title = element_text(size=20, face=\"bold\"))+\n  theme(axis.title.x = element_text(face=\"bold\", size=20))+\n  theme(axis.title.y = element_text(face=\"bold\", size=20)) +   \n  theme(legend.title = element_text(size=16, face=\"bold\"))+\n  ylab(\"AHRR DNA methylation (%5mC)\")+\n  xlab(\"       \")+\n  annotate(\"text\", x =3.3,y = 80, label = \"A\", size=12, face=\"bold\")+\n  scale_x_discrete(breaks=c(\"1\", \"2\", \"3\"), labels=c(\"Normal Weight\", \"Overweight\", \"Obese\"))+\n  stat_summary(fun.y=mean, geom=\"point\", shape=5, size=4)+\n  theme(text = element_text(size=18, face=\"bold\"))\n\n\n\n# GA categories\ne<-ggplot(AHRR_GEE, aes(factor(preterm),ahrr_pos1))+\n  geom_boxplot(size=0.2)+theme_bw()+\n  theme_bw()+\n  theme(plot.title = element_text(size=20, face=\"bold\"))+\n  theme(axis.title.x = element_text(face=\"bold\", size=20))+\n  theme(axis.title.y = element_text(face=\"bold\", size=20)) +   \n  theme(legend.title = element_text(size=16, face=\"bold\"))+\n  ylab(\"         \")+\n  xlab(\"       \")+\n  annotate(\"text\", x =2.3,y = 80, label = \"B\", size=12, face=\"bold\")+\n  scale_x_discrete(breaks=c(\"1\", \"0\"), labels=c(\"Preterm\", \"Full term\"))+\n  stat_summary(fun.y=mean, geom=\"point\", shape=5, size=4)+\n  theme(text = element_text(size=18, face=\"bold\"))\n\n\n\n######Plot for DNA methylation and BWT GA Categoreis\nf<-ggplot(nomiss, aes(factor(BWT_GA_3Cat),ahrr_pos1))+\n  geom_boxplot(size=0.4)+theme_bw()+\n  theme_bw()+\n  theme(plot.title = element_text(size=20, face=\"bold\"))+\n  theme(axis.title.x = element_text(face=\"bold\", size=20))+\n  theme(axis.title.y = element_text(face=\"bold\", size=20)) +   \n  theme(legend.title = element_text(size=16, face=\"bold\"))+\n  ylab(\"       \")+\n  xlab(\"       \")+\n  annotate(\"text\", x =3.3,y = 80, label = \"C\", size=12, face=\"bold\")+\n  scale_x_discrete(breaks=c(\"1\", \"2\", \"3\"), labels=c(\"SGA\", \"AGA\", \"LGA\"))+\n  stat_summary(fun.y=mean, geom=\"point\", shape=5, size=4)+\n  theme(text = element_text(size=16, face=\"bold\"))\n\n# Three panels for \nmultiplot(d,e,f, cols=3)\n\n\n# FIgure 3\nl<-ggplot(ahrrlong2, aes(BMI_2T, value, color = variable)) + \n  geom_point() + geom_smooth(method = \"lm\") + theme_bw(13)+ theme(legend.title=element_text(size=16, face=\"bold\"))+ \n  theme(legend.position=c(.8,.2))+\n  ylab(\"AHRR DNA methylation (%5mC)\") + scale_color_hue(\"Site\", labels=c(\"CpG 1\", \"CpG 2\",\"CpG 3\")) + \n  xlab(\"Maternal BMI\")+\n  theme(plot.title = element_text(size=20, face=\"bold\"))+\n  theme(axis.title.x = element_text(face=\"bold\", size=17))+\n  theme(axis.title.y = element_text(face=\"bold\", size=17)) +   \n  theme(legend.title = element_text(size=16, face=\"bold\"))+\n  theme(text = element_text(size=18, face=\"bold\"))+\n  annotate(\"text\", x =44,y = 95, label = \"A\", size=12, face=\"bold\")\nl\n\n#title   ggtitle(\"Associations of Maternal BMI and Offspring AHRR DNA Methylation\")+\n\n\n#ggplot(ahrrlong2, aes(gest_age_weeks_d, value, color = variable)) + \n# geom_point() + geom_smooth(method = \"lm\") + theme_bw(13)+ theme(legend.title=element_text(size=16, face=\"bold\"))+ \n# ylab(\"AHRR DNA methylation (%5mC)\") + scale_color_hue(\"Site\", labels=c(\"CpG 1\", \"CpG 2\",\"CpG 3\")) + \n#xlab(\"Gestational Age (weeks)\")+\n#theme(plot.title = element_text(size=20, face=\"bold\"))+\n#theme(axis.title.x = element_text(face=\"bold\", size=17))+\n#theme(axis.title.y = element_text(face=\"bold\", size=17)) +   \n#theme(legend.title = element_text(size=16, face=\"bold\"))+\n#theme(text = element_text(size=18, face=\"bold\"))\n#title:   ggtitle(\"Associations of Gestational Age and Offspring AHRR DNA Methylation\")+\n\n\nm<-ggplot(ahrrlong2[ahrrlong2$gest_age_weeks_d >25,], aes(gest_age_weeks_d, value, color = variable)) + \n  geom_point() + geom_smooth(method = \"lm\") + theme_bw(13)+ theme(legend.title=element_text(size=16, face=\"bold\"))+ \n  ylab(\"      \") + scale_color_hue(\"Site\", labels=c(\"CpG 1\", \"CpG 2\",\"CpG 3\")) + \n  xlab(\"Gestational Age (weeks)\")+\n  theme(plot.title = element_text(size=20, face=\"bold\"))+\n  theme(axis.title.x = element_text(face=\"bold\", size=17))+\n  theme(axis.title.y = element_text(face=\"bold\", size=17)) +   \n  theme(legend.title = element_text(size=16, face=\"bold\"))+\n  theme(text = element_text(size=18, face=\"bold\"))+\n  annotate(\"text\", x =44,y = 95, label = \"B\", size=12, face=\"bold\")+\n  theme(legend.position=c(.8,.2))\nm\n\n#title: ggtitle(\"Associations of Gestational Age and AHRR DNA Methylation\")+\n\nn<-ggplot(ahrrlong2, aes(Fenton_Z_score, value, color = variable)) + \n  geom_point() + geom_smooth(method = \"lm\") + theme_bw(13)+ theme(legend.title=element_text(size=16, face=\"bold\"))+ \n  ylab(\"       \") + scale_color_hue(\"Site\", labels=c(\"CpG 1\", \"CpG 2\",\"CpG 3\")) + \n  xlab(\"BWT for GA (Z score))\")+\n  theme(plot.title = element_text(size=17, face=\"bold\"))+\n  theme(axis.title.x = element_text(face=\"bold\", size=17))+\n  theme(axis.title.y = element_text(face=\"bold\", size=17)) +   \n  theme(legend.title = element_text(size=16, face=\"bold\"))+\n  theme(text = element_text(size=18, face=\"bold\"))+\n  annotate(\"text\", x =3,y = 95, label = \"C\", size=12, face=\"bold\")+\n  theme(legend.position=c(.8,.2))\nn\n\nmultiplot(l,m,n, cols=3)\n\n#####   Moving On \n\n# Stats for paper\n\ncor(AHRR_GEE$ahrr_pos1, AHRR_GEE$ahrr_pos2, method=\"pearson\") \ncor(AHRR_GEE$ahrr_pos2, AHRR_GEE$ahrr_pos3, method=\"pearson\") \ncor(AHRR_GEE$ahrr_pos1, AHRR_GEE$ahrr_pos3, method=\"pearson\") \n\n#Age- Not associated\nmodA <- gee(value ~ edad + variable, id = folio, corstr = \"exchangeable\", data = ahrrlong2) \n\nsummary(modA)$coefficients\nprint.model(modA)\n\n# Education\nmodB <- gee(value ~ ed_LT_12+ ed_gt_12 + variable, id = folio, corstr = \"exchangeable\", data = ahrrlong2) \nsummary(modB)$coefficients\nprint.model(modB)\n\nmodB1 <- gee(value ~ ed_LT_12 + variable, id = folio, corstr = \"exchangeable\", data = ahrrlong2) \nsummary(modB1)$coefficients\nprint.model(modB1)\n\n#Male vs. female\nmodC<-gee(value ~ male + variable, id = folio, corstr = \"exchangeable\", data = ahrrlong2) \nsummary(modC)$coefficients\nprint.model(modC)\n\n#Parity\nmodD<-gee(value ~ multiparous + variable, id = folio, corstr = \"exchangeable\", data = ahrrlong2) \nsummary(modD)$coefficients\nprint.model(modD)\n\n#Household \nmodE<-gee(value ~ smoke_house_outside + variable, id = folio, corstr = \"exchangeable\", data = ahrrlong2) \nsummary(modE)$coefficients\nprint.model(modE)\n\n#gestational age\nmodF<-gee(value ~ gest_age_weeks_d + variable, id = folio, corstr = \"exchangeable\", data = ahrrlong2) \nsummary(modF)$coefficients\nprint.model(modF)\n\n#BWT GA\nmodG<-gee(value ~ Fenton_Z_score + variable, id = folio, corstr = \"exchangeable\", data = ahrrlong2) \nsummary(modG)$coefficients\nprint.model(modG)\n\n\nmod2 <- gee(value ~ BMI_2T + variable, id = folio, corstr = \"exchangeable\", data = ahrrlong2) \nsummary(mod2)$coefficients\nprint.model(mod2)\n\nmod5<-gee(value ~ BMI_2T + variable + Christiani_Lab + edad + gest_age_days_d + ed_LT_12 + ed_gt_12, id = folio, corstr = \"exchangeable\", data = ahrrlong2)\nsummary(mod5)$coefficients\n\nmod5a<-gee(value ~ BMI_2T + variable + Christiani_Lab +gest_age_weeks_d + Fenton_Z_score +edad + \n             male+ ed_LT_12 +ed_gt_12 + smoke_house_outside+\n             multiparous, id = folio, corstr = \"exchangeable\", data = ahrrlong2)\nsummary(mod5a)$coefficients\nprint.model(mod5a)\n\n# Christiani lab did not confound THUS the below is final model\nmod5b<-gee(value ~ BMI_2T + variable + gest_age_weeks_d + Fenton_Z_score +edad + \n             male+ ed_LT_12 +ed_gt_12 + smoke_house_outside+\n             multiparous, id = folio, corstr = \"exchangeable\", data = ahrrlong2)\nsummary(mod5b)$coefficients\nprint.model(mod5b)\n\n# Categorical BMI\nnames(ahrrlong2)\nmod5c<-gee(value ~ obese_2t+ overweight_2T + variable + gest_age_weeks_d + Fenton_Z_score +edad + \n             male+ ed_LT_12 +ed_gt_12 + smoke_house_outside+\n             multiparous, id = folio, corstr = \"exchangeable\", data = ahrrlong2)\nsummary(mod5c)$coefficients\nprint.model(mod5c)\n\nnames(ahrrlong2)\nmod5d<-gee(value ~ BMI_2T+ variable + preterm + Fenton_Z_score +edad + \n             male+ ed_LT_12 +ed_gt_12 + smoke_house_outside+\n             multiparous, id = folio, corstr = \"exchangeable\", data = ahrrlong2)\nsummary(mod5d)$coefficients\nprint.model(mod5d)\n\n\nmod5e<-gee(value ~ BMI_2T+ variable + gest_age_weeks_d + SGA+ LGA +edad + \n             male+ ed_LT_12 +ed_gt_12 + smoke_house_outside+\n             multiparous, id = folio, corstr = \"exchangeable\", data = ahrrlong2)\nsummary(mod5e)$coefficients\nprint.model(mod5e)\n\n\nnames(ahrrlong2)\n\n# sensitivity analyses\n\nahrrlong2$cbc_mono\n\nmod5f<-gee(value ~ BMI_2T + variable + cbc_mono+ gran_perc_derived+gest_age_weeks_d +\n             Fenton_Z_score +edad + \n             male+ ed_LT_12 +ed_gt_12 + smoke_house_outside+\n             multiparous, id = folio, corstr = \"exchangeable\", data = ahrrlong2)\nsummary(mod5f)$coefficients\nprint.model(mod5f)\n\n#nonmissing complete case with cbc\n\n\nmycovars6 <- c(\"folio\",\"BMI_2T\", \"gest_age_weeks_d\", \"Fenton_Z_score\",\"edad\",  \"cbc_mono\", \n               \"gran_perc_derived\",\n               \"male\", \"ed_LT_12\", \"ed_gt_12\", \"smoke_house_outside\",\n               \"multiparous\", \"value\",\"variable\",\"ahrr_mean\")\ncbcDF<-ahrrlong2[,c(mycovars6)]\nnomissCbc<-na.omit(cbcDF)\n\nmod5g<-gee(value ~ BMI_2T + variable +gest_age_weeks_d +\n             Fenton_Z_score +edad + \n             male+ ed_LT_12 +ed_gt_12 + smoke_house_outside+\n             multiparous, id = folio, corstr = \"exchangeable\", data = nomissCbc)\nsummary(mod5g)$coefficients\nprint.model(mod5g)\n\n\nmod5h<-gee(value ~ BMI_2T + variable + cbc_mono+ gran_perc_derived+gest_age_weeks_d +\n             Fenton_Z_score +edad + \n             male+ ed_LT_12 +ed_gt_12 + smoke_house_outside+\n             multiparous, id = folio, corstr = \"exchangeable\", data = nomissCbc)\nsummary(mod5h)$coefficients\nprint.model(mod5h)\n\n\n\n\n\n\n\n#########  Let's see what happens to GIT\nprint(sessionInfo(), locale=FALSE)\n \n# Figure out n's by running linear model and counting resids\nresid(modzz)\n#512 in unadjusted lm\n\nmodzz1<-lm(ahrr_mean~BMI_2T+ gest_age_weeks_d +\n             Fenton_Z_score +edad + \n             male+ ed_LT_12 +ed_gt_12 + smoke_house_outside+\n             multiparous, (data=AHRR_GEE))\n\nsummary(modzz1)\nzz1<-resid(modzz1)\nas.data.frame(zz1)\n\n######## 507 in fully adjusted model\n\n########CBC n=405 model\n\nmodzz2<-lm(ahrr_mean~BMI_2T+ cbc_mono+ gran_perc_derived+gest_age_weeks_d +\n             Fenton_Z_score +edad + \n             male+ ed_LT_12 +ed_gt_12 + smoke_house_outside+\n             multiparous, (data=AHRR_GEE))\n\nsummary(modzz2)\nzz2<-resid(modzz2)\nas.data.frame(zz2)\n\n\n############## Folic acid \n\nmodzz3a<-lm(ahrr_mean~BMI_2T+ folic_d+ gest_age_weeks_d +\n             Fenton_Z_score +edad + \n             male+ ed_LT_12 +ed_gt_12 + smoke_house_outside+\n             multiparous, (data=AHRR_GEE))\n\nsummary(modzz3a)\nzz3a<-resid(modzz3a)\nas.data.frame(zz3a)\n\nmodzz3<-gee(value ~ folic_d+ variable, \n            id = folio, corstr = \"exchangeable\", data = ahrrlong2)\nsummary(modzz3)$coefficients\nprint.model(modzz3)\n\n# extract subest where folic_d not NA\nmycovars5 <- c(\"folio\",\"BMI_2T\", \"folic_d\", \"gest_age_weeks_d\", \"Fenton_Z_score\",\"edad\",  \n                 \"male\", \"ed_LT_12\", \"ed_gt_12\", \"smoke_house_outside\",\n                 \"multiparous\", \"value\",\"variable\",\"ahrr_mean\")\nfolicDF<-ahrrlong2[,c(mycovars5)]\nnomissFolic<-na.omit(folicDF)\n\nmodzz4<-gee(value ~ folic_d+ variable, \n            id = folio, corstr = \"exchangeable\", data = ahrrlong2)\nsummary(modzz4)$coefficients\nprint.model(modzz4)\n\n\nmodzz5<-gee(value ~ BMI_2T + variable +gest_age_weeks_d +\n             Fenton_Z_score +edad + \n             male+ ed_LT_12 +ed_gt_12 + smoke_house_outside+\n             multiparous, id = folio, corstr = \"exchangeable\", data = nomissFolic)\nsummary(modzz5)$coefficients\nprint.model(modzz5)\n\n#folic acid intake\n\nmodzz6<-gee(value ~ BMI_2T +folic_d+ variable +gest_age_weeks_d +\n             Fenton_Z_score +edad + \n              male+ ed_LT_12 +ed_gt_12 + smoke_house_outside+\n              multiparous, id = folio, corstr = \"exchangeable\", data = nomissFolic)\nsummary(modzz6)$coefficients\nprint.model(modzz6)\n\n\nmodzz7<-lm(ahrr_mean~BMI_2T +folic_d +gest_age_weeks_d +\n             Fenton_Z_score +edad + \n             male+ ed_LT_12 +ed_gt_12 + smoke_house_outside+\n             multiparous, (nomissFolic))\n# n=65 for folic acid non-missings\nsummary(modzz7)\nzz7<-resid(modzz7)\nas.data.frame(zz7)\n\n# Laborotory storage batch effects\n\n\n\nmod5a<-gee(value ~ BMI_2T + variable + Christiani_Lab +gest_age_weeks_d + Fenton_Z_score +edad + \n             male+ ed_LT_12 +ed_gt_12 + smoke_house_outside+\n             multiparous, id = folio, corstr = \"exchangeable\", data = ahrrlong2)\nsummary(mod5a)$coefficients\nprint.model(mod5a)\n\n# Christiani lab did not confound THUS the below is final model\nmod5b<-gee(value ~ BMI_2T + variable + gest_age_weeks_d + Fenton_Z_score +edad + \n             male+ ed_LT_12 +ed_gt_12 + smoke_house_outside+\n             multiparous, id = folio, corstr = \"exchangeable\", data = ahrrlong2)\nsummary(mod5b)$coefficients\nprint.model(mod5b)",
    "created" : 1426774676050.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1758379257",
    "id" : "D614FB1E",
    "lastKnownWriteTime" : 1426774914,
    "path" : "C:/R_Work_Dir/ahrr_2015_03_19.R",
    "project_path" : "ahrr_2015_03_19.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}